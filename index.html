<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Nest - Catalog</title>

<style>
body { font-family: Arial; background:#f4f4f4; margin:20px; }
h1 { text-align:center; }

#adminBar { text-align:center; margin-bottom:15px; }
button { padding:7px 12px; border-radius:6px; border:none; cursor:pointer; }
.adminOnly { display:none; }

#catalog {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:15px;
}

.item {
  background:white;
  padding:10px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
  text-align:center;
  position:relative;
}

.item img {
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:6px;
}

.stockOut {
  position:absolute;
  inset:0;
  background:rgba(255,0,0,.85);
  color:white;
  font-size:22px;
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:8px;
}

/* Admin Controls */
#adminPanel { display:none; margin-bottom:20px; text-align:center; }
#adminPanel input[type="file"] { margin:5px; }
#adminPanel input[type="text"], #adminPanel input[type="number"] { margin:5px; padding:5px; border-radius:4px; border:1px solid #ccc; }
</style>
</head>

<body>

<h1>Digital Nest (Online)</h1>

<div id="adminBar">
  <button id="loginBtn">Admin Login</button>
  <button id="logoutBtn" style="display:none;background:red;color:white;">Logout</button>
</div>

<!-- Admin Controls -->
<div id="adminPanel" class="adminOnly">
  <input type="file" id="photoInput" accept="image/*">
  <input type="text" id="nameInput" placeholder="Item Name">
  <input type="text" id="priceInput" placeholder="Price">
  <input type="number" id="qtyInput" placeholder="Quantity">
  <button onclick="addItem()" style="background:green;color:white;">Add Item</button>
  <br>
  <input type="file" id="importFile" accept=".json">
  <button onclick="importJSON()">Import JSON</button>
  <button onclick="exportJSON()">Export JSON</button>
</div>

<div id="catalog"></div>

<script>
const ADMIN_PASSWORD = "admin123"; // Change password here
let isAdmin = false;

// Load catalog from localStorage or empty array
let items = JSON.parse(localStorage.getItem("catalog")) || [];

const catalog = document.getElementById("catalog");
const adminPanel = document.getElementById("adminPanel");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");

function save() {
  localStorage.setItem("catalog", JSON.stringify(items));
  render();
}

function render() {
  catalog.innerHTML = "";
  items.forEach((item, i) => {
    const div = document.createElement("div");
    div.className = "item";

    div.innerHTML = `
      <img src="${item.photo}">
      <h3>${item.name}</h3>
      <p>Price: ${item.price}</p>
      <p>Qty: ${item.qty}</p>
    `;

    // Stock out overlay
    if(item.qty <= 0){
      const overlay = document.createElement("div");
      overlay.className="stockOut";
      overlay.textContent="STOCK OUT";
      div.appendChild(overlay);
    }

    // Admin controls per item
    if(isAdmin){
      const priceInput = document.createElement("input");
      priceInput.type="text";
      priceInput.value = item.price;

      const qtyInput = document.createElement("input");
      qtyInput.type="number";
      qtyInput.value = item.qty;

      const saveBtn = document.createElement("button");
      saveBtn.textContent="Save";
      saveBtn.style.background="orange";
      saveBtn.onclick = () => {
        item.price = priceInput.value;
        item.qty = parseInt(qtyInput.value);
        save();
      };

      const delBtn = document.createElement("button");
      delBtn.textContent="Delete";
      delBtn.style.background="crimson";
      delBtn.style.color="white";
      delBtn.onclick = () => {
        if(confirm("Delete this item?")){
          items.splice(i,1);
          save();
        }
      };

      div.append(priceInput, qtyInput, saveBtn, delBtn);
    }

    catalog.appendChild(div);
  });
}

// Admin Login
loginBtn.onclick = () => {
  const pass = prompt("Enter Admin Password:");
  if(pass === ADMIN_PASSWORD){
    isAdmin = true;
    adminPanel.style.display="block";
    loginBtn.style.display="none";
    logoutBtn.style.display="inline-block";
    render();
  } else alert("Wrong password!");
};

// Logout
logoutBtn.onclick = () => {
  isAdmin = false;
  adminPanel.style.display="none";
  loginBtn.style.display="inline-block";
  logoutBtn.style.display="none";
  render();
};

// Add Item (Admin)
function addItem(){
  const file = document.getElementById("photoInput").files[0];
  const name = document.getElementById("nameInput").value.trim();
  const price = document.getElementById("priceInput").value;
  const qty = parseInt(document.getElementById("qtyInput").value) || 0;

  if(!file || !name || !price) return alert("Fill all fields!");

  const reader = new FileReader();
  reader.onload = () => {
    items.push({ photo: reader.result, name, price, qty });
    save();
    document.getElementById("photoInput").value="";
    document.getElementById("nameInput").value="";
    document.getElementById("priceInput").value="";
    document.getElementById("qtyInput").value="";
  };
  reader.readAsDataURL(file);
}

// Import JSON (Admin)
function importJSON(){
  const file = document.getElementById("importFile").files[0];
  if(!file) return alert("Select JSON file!");
  const reader = new FileReader();
  reader.onload = e => {
    try {
      const data = JSON.parse(e.target.result);
      if(Array.isArray(data)){
        items = data;
        save();
        alert("Catalog imported!");
      } else alert("Invalid JSON format");
    } catch {
      alert("Error reading JSON file");
    }
  };
  reader.readAsText(file);
}

// Export JSON (Admin)
function exportJSON(){
  const dataStr = JSON.stringify(items, null, 2);
  const blob = new Blob([dataStr], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "catalog.json";
  document.body.appendChild(a);
  a.click();
  a.remove();
}

render();
</script>

</body>
</html>
