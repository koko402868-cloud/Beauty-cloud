<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Nest</title>

<style>
body { font-family: Arial; background:#f4f4f4; margin:20px; }
h1 { text-align:center; }

#catalog {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:15px;
}

.item {
  background:white;
  padding:10px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
  text-align:center;
  position:relative;
}

.item img {
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:6px;
}

.stockOut {
  position:absolute;
  inset:0;
  background:rgba(255,0,0,.85);
  color:white;
  font-size:22px;
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:8px;
}

/* hidden admin panel */
#adminPanel {
  display:none;
  text-align:center;
  margin-bottom:15px;
}
</style>
</head>

<body>

<h1>Digital Nest (Online)</h1>

<!-- ADMIN ONLY -->
<div id="adminPanel">
  <input type="file" id="importFile" accept=".json">
  <button onclick="importJSON()">Import JSON</button>
</div>

<div id="catalog"></div>

<script>
let items = JSON.parse(localStorage.getItem("catalog")) || [];

const catalog = document.getElementById("catalog");
const adminPanel = document.getElementById("adminPanel");

/* SECRET ADMIN KEY */
document.addEventListener("keydown", e => {
  if (e.ctrlKey && e.shiftKey && e.key === "I") {
    adminPanel.style.display = "block";
    alert("Admin Import Mode Enabled");
  }
});

function render() {
  catalog.innerHTML="";
  items.forEach(item=>{
    const div=document.createElement("div");
    div.className="item";

    div.innerHTML=`
      <img src="${item.photo}">
      <h3>${item.name}</h3>
      <p>Price: ${item.price}</p>
      <p>Qty: ${item.qty}</p>
    `;

    if(item.qty<=0){
      const s=document.createElement("div");
      s.className="stockOut";
      s.textContent="STOCK OUT";
      div.appendChild(s);
    }

    catalog.appendChild(div);
  });
}

function importJSON() {
  const file=document.getElementById("importFile").files[0];
  if(!file) return alert("Select JSON file");

  const reader=new FileReader();
  reader.onload=e=>{
    try{
      const data=JSON.parse(e.target.result);
      if(Array.isArray(data)){
        items=data;
        localStorage.setItem("catalog",JSON.stringify(items));
        render();
        alert("Catalog Updated!");
      }else{
        alert("Invalid JSON");
      }
    }catch{
      alert("JSON Error");
    }
  };
  reader.readAsText(file);
}

render();
</script>

</body>
</html>
